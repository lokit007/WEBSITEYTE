<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Google Maps JavaScript API v3 Example: Place Search</title>
<script
	src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&libraries=places"></script>

<style>
#map {
	height: 400px;
	width: 600px;
	border: 1px solid #333;
	margin-top: 0.6em;
}
</style>

<script>
	var map;
	var infowindow;

	function initialize() {
		// Khởi tạo bản đồ
		// Vị trí trung tâm 20.9875830,105.8316770 (Định Công)
		var pyrmont = new google.maps.LatLng(16.451534, 107.566346);

		// khởi tạo bản đồ vào div#map
		map = new google.maps.Map(document.getElementById('map'), {
			mapTypeId : google.maps.MapTypeId.ROADMAP,
			// ROADMAP displays the normal, default 2D tiles of Google Maps.
			// SATELLITE displays photographic tiles.
			// HYBRID displays a mix of photographic tiles and a tile layer for prominent features (roads, city names).
			// TERRAIN displays physical relief tiles for displaying elevation and water features (mountains, rivers, etc.).
			center : pyrmont,
			zoom : 15
		// Zoom hiện tại
		});

		// Tạo đối tượng request
		var request = {
			location : pyrmont, // Tìm từ vị trí trung tâm
			radius : 500, // Bán kính 500m
			types : [ 'atm' ]
		// Tìm tất cả nhà hàng
		};
		// Hiển thị thông tin về địa điểm
		infowindow = new google.maps.InfoWindow();
		var service = new google.maps.places.PlacesService(map);
		// Thực hiện gọi hàm nearbySearch để tìm những atm lân cận và trả về thực hiện
		// hàm callback
		service.nearbySearch(request, callback);
	}
	function customSearch() {
		// Khởi tạo bản đồ
		// Vị trí trung tâm 20.9875830,105.8316770 (Định Công)
		var pyrmont = new google.maps.LatLng(16.451534, 107.566346);

		// khởi tạo bản đồ vào div#map
		map = new google.maps.Map(document.getElementById('map'), {
			mapTypeId : google.maps.MapTypeId.ROADMAP,
			center : pyrmont,
			zoom : 15
		});

		var place_type = document.getElementById('place_type');
		var selected_type = place_type.options[place_type.selectedIndex].value;
		// Tạo đối tượng request
		var request = {
			location : pyrmont, // Tìm từ vị trí trung tâm
			radius : document.getElementById('radius').value, // Bán kính 500m
			types : [ selected_type ]
		// Tìm tất cả atm
		};
		// Hiển thị thông tin về địa điểm
		infowindow = new google.maps.InfoWindow();
		var service = new google.maps.places.PlacesService(map);
		// Thực hiện gọi hàm nearbySearch để tìm những atm lân cận và trả về thực hiện
		// hàm callback
		service.nearbySearch(request, callback);

	}
	function callback(results, status) {
		if (status == google.maps.places.PlacesServiceStatus.OK) {
			for (var i = 0; i < results.length; i++) {
				// Duyệt từng địa điểm và đánh dấu lên bản đồ
				createMarker(results[i]);
			}
		}
	}
	// Hàm đánh dấu lên bản đồ từ 1 đối tượng địa điểm place
	function createMarker(place) {
		var placeLoc = place.geometry.location;
		var marker = new google.maps.Marker({
			map : map,
			position : place.geometry.location
		});

		google.maps.event.addListener(marker, 'click', function() {
			infowindow.setContent(place.name);
			infowindow.open(map, this);
		});
	}

	google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>
<body>
	<!-- Tạo custom các control để thực hiện tìm tùy chỉnh -->
	Loại địa điểm:
	<select id="place_type">
		<option value="atm">ATM</option>
		<option value="school">Trường học</option>
		<option value="store">Cửa hàng</option>
		<option value="hospital">Bệnh viện</option>
	</select> Bán kính:
	<input type="text" id="radius" />
	<br />
	<input type="button" onclick="customSearch()" value="Tìm" />
	<div id="map"></div>
	<div id="text"></div>
</body>
</html>