<html>
<head>
<script type="text/javascript" src="../js/jquery.js"></script>
<script type="text/javascript"
	src="http://www.vietbando.com/maps/API/VBDMapAPI.js?key=e7vjH+pgQHuSyV75dwG6hiTahxuHdpFtl2+wwQOLh/iDYHT0cctAng=="></script>
<script
	src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&libraries=places"></script>
<script type="text/javascript">
	var map;
	var infowindow;
	function showLocation(position) {
		var latitude = position.coords.latitude;
		var longitude = position.coords.longitude;
		if (VBrowserIsCompatible()) {
			map = new VMap(document.getElementById('container'));
			var pt = new VLatLng(latitude, longitude);
			map.setCenter(pt, 8);
			map.addControl(new VLargeMapControl());
			map.addControl(new VScaleControl());
			map.addControl(new VOverviewMapControl());
			map.disableDoubleClickZoom();
			var marker = new VMarker(pt, new VIcon());
			map.addOverlay(marker);
			VEvent.addListener(marker, 'click', function(obj, latlng) {
				obj.openInfoWindow('5 Nguyễn Chí Diễu, Sơn Trà, Đà Nẵng');
			});
			marker.enableDragging();
			VEvent.addListener(marker, "dragend", function(obj, latlng) {
				marker.openInfoWindow("Bạn vừa di chuyển marker");
			});
			/* map.openInfoWindow(map.getCenter(), 'Xin chào, Tôi ở đây!'); */
			var request = {
					location : pyrmont, // Tìm từ vị trí trung tâm
					radius : 50000, // Bán kính 500m
					types : [ 'hospital' ]
				// Tìm tất cả nhà hàng
				};
				// Hiển thị thông tin về địa điểm
				infowindow = new google.maps.InfoWindow();
				var service = new google.maps.places.PlacesService(map);
				// Thực hiện gọi hàm nearbySearch để tìm những atm lân cận và trả về thực hiện
				// hàm callback
				service.nearbySearch(request, callback);
		}
	}
	function errorHandler(err) {
		if (err.code == 1) {
			alert("Error: Access is denied!");
		} else if (err.code == 2) {
			alert("Error: Position is unavailable!");
		}
	}
	function callback(results, status) {
		if (status == google.maps.places.PlacesServiceStatus.OK) {
			for (var i = 0; i < results.length; i++) {
				// Duyệt từng địa điểm và đánh dấu lên bản đồ
				createMarker(results[i]);
			}
		}
	}
	// Hàm đánh dấu lên bản đồ từ 1 đối tượng địa điểm place
	function createMarker(place) {
		var placeLoc = place.geometry.location;
		var marker = new VMarker(placeLoc, new VIcon());
		VEvent.addListener(marker, 'click', function() {
			infowindow.setContent(place.name);
			infowindow.open(map, this);
		});
		map.addOverlay(marker);
	}
	function getLocation() {
		if (navigator.geolocation) {
			// timeout at 60000 milliseconds (60 seconds)
			var options = {
				timeout : 60000
			};
			navigator.geolocation.getCurrentPosition(showLocation,
					errorHandler, options);
		} else {
			alert("Sorry, browser does not support geolocation!");
		}
	}
</script>
</head>
<body onload="getLocation()">
	<div id="container"
		style="height: 500px; position: relative; margin: 10px; border: 1px #b1c4d5 solid;"></div>
</body>
</html>